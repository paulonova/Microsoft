window.Demandbase=window.Demandbase||{},window.Demandbase.SiteOptimization={CLASS_CLOSED:"closed",CLASS_CLOSE_BUTTON:"recommended-block__close-button",CLASS_CLOSED_CONTENT:"recommended-block_closed__content",CLASS_HIDDEN:"_hidden",CLASS_LIST:"recommended-block__list",CLASS_LIST_ITEM:"recommended-block__list__recommended-item",CLASS_LIST_ITEM_TITLE:"recommended-block__list__recommended-item__title",CLASS_LOGO_WRAPPER:"recommended-block__logo-wrapper",CLASS_MAIN_BOTTOM:"BottomAlignedBlock",CLASS_MAIN_RIGHT:"RightAlignedBlock",CLASS_MAIN_DEFAULT:"defaultBlock",CLASS_OPENED:"opened",CLASS_OPEN_CONTENT:"recommended-block_opened__content",CLASS_OPEN_TITLE:"recommended-block_open__title",CLASS_OPEN_TITLE_WRAPPER:"recommended-block_open__title-wrapper",CLASS_RIGHT_RAIL:"RightRail",CLASS_ROOT:"recommended-block",CLASS_SWITCHER_CONTROL:"recommended-block__slider__switchers",CLASS_SWITCHER_CONTROL_ITEM:"recommended-block__slider__switchers-item",CLASS_SWITCHER_CONTROL_WRAPPER:"recommended-block__slider__switchers-wrapper",CLASS_TITLE:"recommended-block__title",DIV:"div",SESSION_BLOCK_OPEN_STATE:"openedRecommendationBlock",PERSONALIZATION_BLACKLIST_DOMAINS:["adaptiveinsights.com","workday.com","getpattern.com","platfora.com","rallyteam.com"],DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE:3,MAX_NUMBER_OF_ITEMS:6,DEFAULT_CONFIGURATION:{additionalClass:null,backgroundColorClass:null,closedTitle:"Recommended Content",companyProfile:null,cssFileURL:"https://tag.demandbase.com/shared/siteOptimization.css",delay:0,enabled:!1,fadeIn:0,fontColor:null,fontName:null,googleAnalyticsTrackerName:null,isGoogleAnalyticsEnabled:!1,isRippleAnimation:!0,isSwitchersDots:!0,isSwitchersArrows:!1,itemBackgroundColor:null,mainClass:"defaultBlock",openByDefault:!1,openTitle:null,recommendationApiURL:"https://site-optimization-api.company-target.com/recommend/",recommendationCompanyName:null,recommendationCompanyId:null,recommendationKey:null,recommendationsProtocol:"forceHTTPS",recommendationUrl:window.location.href,showCloseButton:!0,showCompanyName:!0,showFeedbackLink:!1,showIndicatorArrows:!0,showLogo:!0,showLogoWhenClosed:!0,showLogoWhenOpen:!1,showOnlyOnScroll:!1,showTitleWhenClosed:!0,showTitleWhenOpen:!0,switcherArrowsColor:"#444",state:{openedRecommendationBlock:null},widgetBackgroundColor:null,widgetContainerId:null,solveConversionProbabilities:!1},configuration:{},initialize:function(e){this.isAdmin=this.getQueryVariable("admin"),e&&Demandbase.Shims.assign(this.configuration,this.DEFAULT_CONFIGURATION,e),this.insertStylesheet(),this.setGoogleAnalyticsObject(),this.configuration.companyProfile?this.setRecommendationsData(this.configuration.companyProfile):this.checkInitialData()},addAnimation:function(e){if(this.configuration.isRippleAnimation){var t=this,i=document.createElement(this.DIV);this.addClass(i,"animation-ripple-block"),e.appendChild(i);var n=setInterval(function(){if(document.querySelector("."+t.CLASS_ROOT)){var e=document.querySelector(".closed .animation-ripple-block");e&&t.addClass(e,"show-animation"),clearInterval(n)}},100)}},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},addFeedbackClickHandler:function(){var e=document.querySelector(".recommended-block__feedbacklink-wrapper");e&&Demandbase.Utilities.addEventListener(e,"click",this.feedbackLinkClickHandler.bind(this))},addSlidesControls:function(e){this.configuration.isSwitchersDots?(this.addClass(e,"recommended-block__slider-wrapper"),e.appendChild(this.buildSwitchersDots())):this.configuration.isSwitchersArrows&&(this.addClass(e,"recommended-block__slider-arrow-wrapper"),e.appendChild(this.buildSwitchersArrows()))},buildConversionPopup:function(e){var t="Decrease in Chance",i=" decrease_percent",n='<div class="recommendation-block__conversion-popup"><p class="recommendation-block__conversion-popup__title">Where is the AI taking me?</p><ul class="recommendation-block__conversion-popup__conversions">';if(void 0!==e.conversion_pages)for(var o=e.conversion_pages,a=0;a<o.length;a++){var s=o[a];void 0!==s.prob_increase_percentage&&null!==s.prob_increase_percentage&&void 0!==s.conversion_page&&null!==s.conversion_page&&(0<s.prob_increase_percentage&&(t="Increase in Chance",i=""),n+='<li class="recommendation-block__conversion-popup__conversion"><p class="recommendation-block__conversion-popup__conversion__percent-block'+i+'"><span class="recommendation-block__conversion-popup__arrow'+i+'"></span><span class="recommendation-block__conversion-popup__conversion__percent">'+s.prob_increase_percentage+"%</span>"+t+'</p><p class="recommendation-block__conversion-popup__conversion__increase-text">to get customer to:<span class="recommendation-block__conversion-popup__conversion__url">'+s.conversion_page+"</span></p></li>")}return n+="</ul></div>"},buildCloseButton:function(){var e=document.createElement(this.DIV);return e.innerHTML="X",this.addClass(e,this.CLASS_CLOSE_BUTTON),e},buildClosedTitle:function(){var e=document.createElement("p");return e.innerText=this.configuration.closedTitle.trim(),this.addClass(e,this.CLASS_TITLE),e},buildFeedbackLink:function(){var e=document.createElement(this.DIV);return this.addClass(e,"recommended-block__feedbacklink-wrapper"),this.addClass(e,"affect"),e.innerHTML='<p class="recommended-block___contentOfOpenedBlock__feedbackLink_link-text affect">Hey, I\'m not from '+this.configuration.recommendationCompanyName+'.</p><div class="recommended-block__feedbackLinkDiv__popup affect"><span class="recommended-block__feedbackLinkDiv__popup__tile">Enter your company name</span><input type="text" class="recommended-block__feedbackLinkDiv__popup__input" placeholder="Company name"></div>',e},buildOpenedTitle:function(){var e=document.createElement("p"),t=this.getOpenedTitle();return e.innerHTML=t,this.addClass(e,this.CLASS_OPEN_TITLE),e},buildOpenedTitleWrapper:function(e){var t=document.createElement(this.DIV);return e&&t.appendChild(this.buildOpenedTitle()),this.addClass(t,this.CLASS_OPEN_TITLE_WRAPPER),t},buildSlidesList:function(){var e=document.createElement(this.DIV),t=document.createElement("ul");return this.addClass(t,this.CLASS_LIST),e.appendChild(t),this.addSlidesControls(e),e},buildSwitchersArrows:function(){var e=document.createElement(this.DIV);return this.addClass(e,"recommendation-block__arrows-list"),e.innerHTML="",e},buildSwitchersDots:function(){var e=document.createElement(this.DIV);return this.addClass(e,this.CLASS_SWITCHER_CONTROL_WRAPPER),e.innerHTML='<ul class="'+this.CLASS_SWITCHER_CONTROL+'"></ul>',e},feedbackLinkClickCallback:function(){var e=document.querySelector(".recommended-block__feedbackLinkDiv__popup");this.toggleClass(e,"_opened_feedback")},feedbackLinkClickHandler:function(e){this.hasClass(e.target,"recommended-block__feedbackLinkDiv__popup__input")||this.feedbackLinkClickCallback()},feedbackResponseHandler:function(e){200<=e.status&&e.status<400&&this.feedbackSendCallback()},feedbackSendCallback:function(){var e=document.querySelector(".recommended-block__feedbackLinkDiv__popup");this.removeClass(e,"_opened_feedback"),document.querySelector(".recommended-block___contentOfOpenedBlock__feedbackLink_link-text").innerHTML="Thanks for the feedback!",document.querySelector(".recommended-block__feedbackLinkDiv__popup__input").value=""},findAncestor:function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e},getIndicatorArrow:function(){return this.configuration.showIndicatorArrows?'<span class="link-indicator">â–¶</span>':""},getItemFromStorage:function(e){if(Demandbase.Utilities.isStorageEnabled("sessionStorage"))return window.sessionStorage.getItem(e);if(Demandbase.Utilities.isStorageEnabled("localStorage"))return window.localStorage.getItem(e);if(Demandbase.Utilities.isCookieEnabled())for(var t=document.cookie.split(";"),i=0;i<t.length;i++)if(-1!==Demandbase.Shims.indexOf(t[i],e))return t[i].split("=")[1];return this.configuration.state[e]},getOpenedTitle:function(){var e="",t="";return this.configuration.openTitle?e=this.configuration.openTitle.trim()+" ":(e="Recommendations for ",this.configuration.mainClass===this.CLASS_MAIN_DEFAULT&&(e="Here's what we recommend for ")),this.configuration.showCompanyName&&(t="<span class='company-name-wrapper'>"+this.configuration.recommendationCompanyName+"</span>"),e+t},hasClass:function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},insertStylesheet:function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",this.configuration.cssFileURL),void 0!==e&&document.getElementsByTagName("head")[0].appendChild(e)},insertWidget:function(e){if(this.configuration.widgetContainerId)document.getElementById(this.configuration.widgetContainerId)&&document.getElementById(this.configuration.widgetContainerId).appendChild(e);else{var t=document.createElement(this.DIV);t.id="db-ai-personalization-container",t.appendChild(e),document.body.appendChild(t)}},sendGoogleAnalyticsEvent:function(e,t,i){var n=Demandbase.Connectors.Google_Analytics;if(this.configuration.isGoogleAnalyticsEnabled&&n){var o=this.configuration.googleAnalyticsTrackerName;if(!o){var a=n.getTrackerInfo().filter(function(e){return"universal"===e.type});a[0]&&(o=a[0].name)}var s=o?o+".send":"send";window.ga(s,{hitType:"event",eventCategory:e,eventAction:t,eventLabel:i,nonInteraction:!0,transport:"beacon"})}},setFontColor:function(e){var t=void 0!==e?e:this.configuration.fontColor,i=document.getElementsByClassName(this.CLASS_LIST_ITEM_TITLE);if(void 0!==i&&i.length)for(var n=0;n<i.length;n++)i[n].style.color=t;if(this.configuration.showTitleWhenOpen){var o=document.querySelector("."+this.CLASS_OPEN_TITLE_WRAPPER),a=document.querySelector("."+this.CLASS_OPEN_TITLE);a&&o&&(a.style.color=t,o.style.color=t)}if(this.configuration.showTitleWhenClosed){var s=document.querySelector("."+this.CLASS_TITLE);s&&(s.style.color=t)}},setFontFamily:function(e){var t=void 0!==e?e:this.configuration.fontName;document.getElementsByClassName(this.CLASS_ROOT)[0].style.fontFamily=t},setGoogleAnalyticsObject:function(){window.Demandbase.SiteOptimization.configuration.isGoogleAnalyticsEnabled&&void 0===window.ga&&(window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date)},setItemBackgroundColor:function(e){for(var t=void 0!==e?e:this.configuration.itemBackgroundColor,i=document.getElementsByClassName(this.CLASS_LIST_ITEM),n=0;n<i.length;n++)i[n].style.backgroundColor=t},setItemToStorage:function(e,t){Demandbase.Utilities.isStorageEnabled("sessionStorage")?sessionStorage.setItem(e,t):Demandbase.Utilities.isStorageEnabled("localStorage")?localStorage.setItem(e,t):Demandbase.Utilities.isCookieEnabled()?document.cookie=e+"="+t:this.configuration.state[e]=t},setStyles:function(){this.setFontColor(this.configuration.fontColor),this.configuration.mainClass===this.CLASS_MAIN_BOTTOM&&this.setItemBackgroundColor(this.configuration.itemBackgroundColor),this.setWidgetBackgroundColor(this.configuration.widgetBackgroundColor),this.setFontFamily(this.configuration.fontName)},setWidgetBackgroundColor:function(e){var t=void 0!==e?e:this.configuration.widgetBackgroundColor;document.getElementsByClassName(this.CLASS_ROOT)[0].style.backgroundColor=t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},toggleClass:function(e,t,i){void 0===i&&(i=!this.hasClass(e,t)),i?this.addClass(e,t):this.removeClass(e,t)},alignListViewBlock:function(e){document.body.clientHeight!==window.innerHeight&&this.ifRightRailed()&&this.addClass(e,"right-margined")},recommendationRequest:function(){new XMLHttpRequest;var e=this.configuration.recommendationUrl,t=this;this.getRecommendations(this.configuration.recommendationCompanyId,e,this.configuration.recommendationKey,function(e){e.recommendations&&(e.recommendations.length<1||(t.overrideSid()&&(t.configuration.recommendationCompanyName=e.company_name),t.documentReady(e)))})},buildContentOfClosedBlock:function(e){var t=[],i=document.createElement(this.DIV);this.addClass(i,this.CLASS_CLOSED_CONTENT),this.configuration.showTitleWhenClosed&&t.push(this.buildClosedTitle()),Array.prototype.forEach.call(t,function(e,t){i.appendChild(e)}),e.appendChild(i)},buildContentOfOpenedBlock:function(e){var t=[],i=document.createElement(this.DIV);this.addClass(i,this.CLASS_OPEN_CONTENT),this.configuration.showCloseButton&&t.push(this.buildCloseButton()),(this.configuration.showLogoWhenOpen||this.configuration.showTitleWhenOpen)&&t.push(this.buildOpenedTitleWrapper(this.configuration.showTitleWhenOpen)),t.push(this.buildSlidesList()),this.configuration.showFeedbackLink&&t.push(this.buildFeedbackLink()),Array.prototype.forEach.call(t,function(e,t){i.appendChild(e)}),e.appendChild(i)},addCustomStyles:function(e){var t=document.createElement("style");return this.configuration.customCSS&&(t.type="text/css",t.appendChild(document.createTextNode(this.configuration.customCSS)),e.appendChild(t)),t},setFadeInOnScroll:function(t){var e=this;0!==this.configuration.fadeIn&&-1!==this.configuration.fadeIn&&t.setAttribute("style","transition: opacity "+this.configuration.fadeIn/1e3+"s;");var i=this;this.configuration.showOnlyOnScroll?window.onscroll=function(){t.style.opacity<1&&(t.style.opacity=1,e.sendGoogleAnalyticsEvent("AI personalization - Company Logo","impression","Company SID: "+e.configuration.recommendationCompanyId)),i.onscroll(i,t)}:(setTimeout(function(){t.style.opacity=1},this.configuration.delay||0),window.onscroll=function(e){i.onscroll(i,t)})},createWidgetWrapper:function(){var e=document.createElement(this.DIV);return this.addClass(e,this.CLASS_ROOT),this.configuration.mainClass===this.CLASS_RIGHT_RAIL||this.configuration.openByDefault||"true"===this.getItemFromStorage(this.SESSION_BLOCK_OPEN_STATE)?this.addClass(e,this.CLASS_OPENED):this.addClass(e,this.CLASS_CLOSED),e},addClassesForWidget:function(e){this.addClass(e,this.configuration.mainClass),this.configuration.additionalClass&&this.addClass(e,this.configuration.additionalClass),this.configuration.backgroundColorClass&&this.addClass(e,this.configuration.backgroundColorClass)},onTouchCallback:function(e,t,i,n,o){function a(){l.removeClass(c,l.CLASS_OPENED),l.addClass(c,l.CLASS_CLOSED),l.setItemToStorage(l.SESSION_BLOCK_OPEN_STATE,"false")}function s(){l.removeClass(c,l.CLASS_CLOSED),l.addClass(c,l.CLASS_OPENED),l.setItemToStorage(l.SESSION_BLOCK_OPEN_STATE,"true")}var r,l=this,c=document.querySelector("."+l.CLASS_ROOT),d=c.querySelectorAll("."+l.CLASS_LIST)[0],m=d.querySelectorAll("."+l.CLASS_LIST_ITEM),u=850<window.innerWidth?3:2,h=Math.ceil(m.length/u),_=d.parentNode.clientWidth;if("end"===i){var S=(_-m[0].clientWidth*u)/(2*u);if(r=-_*(h-1)+(m.length%u?(2*S+m[0].clientWidth)*(u-m.length%u):0),"right"==t&&0<parseInt(d.style.left)||"left"==t&&m.length<=u?d.style.left="0px":"left"==t&&Math.abs(parseInt(d.style.left))>-r&&(d.style.left=r+"px"),"right"!=t&&"left"!=t||(this.toggleClass(document.querySelector(".recommendation-block__arrows-list_common.left-arrow"),"_inactive",0===parseInt(d.style.left)),this.toggleClass(document.querySelector(".recommendation-block__arrows-list_common.right-arrow"),"_inactive",Math.abs(parseInt(d.style.left))===Math.floor(Math.abs(r)))),"none"===t)if(e.target.className!==l.CLASS_CLOSE_BUTTON){if(l.hasClass(c,l.CLASS_CLOSED))s();else if(this.configuration.mainClass===l.CLASS_MAIN_BOTTOM)if(l.hasClass(e.target,"affect")||!l.hasClass(e.target,"right-arrow")&&!l.hasClass(e.target,"left-arrow"))if(l.hasClass(e.target,"recommended-block_arrows-part")||l.hasClass(e.target,"recommended-block_arrows-part_round")){if(l.hasClass(e.target.offsetParent,"right-arrow"))c.querySelectorAll(".right-arrow .recommended-block_arrows-part")[0].click();else c.querySelectorAll(".left-arrow .recommended-block_arrows-part")[0].click()}else l.hasClass(e.target.offsetParent,l.CLASS_LIST_ITEM)&&e.target.offsetParent.querySelectorAll("."+l.CLASS_LIST_ITEM_TITLE)[0].click();else a()}else l.hasClass(c,l.CLASS_OPENED)&&a();else"up"==t?l.hasClass(c,l.CLASS_CLOSED)&&s():"down"==t&&l.hasClass(c,l.CLASS_OPENED)&&a()}else"move"!=i||"right"!=t&&"left"!=t||(d.style.transition="left 1s",d.style.left=parseInt(d.style.left)+o+"px")},documentReady:function(t){var i=this;Demandbase.ErrorReporter.wrap(function(){if(!1!==t.should_display){var e=i.createWidgetWrapper();i.addCustomStyles(e),i.alignListViewBlock(e),i.addClassesForWidget(e),i.buildContentOfClosedBlock(e),i.buildContentOfOpenedBlock(e),i.addAnimation(e),i.insertWidget(e),i.configuration.showOnlyOnScroll||i.sendGoogleAnalyticsEvent("AI personalization - Company Logo","impression","Company SID: "+i.configuration.recommendationCompanyId),i.setFadeInOnScroll(e),i.configuration.mainClass===i.CLASS_MAIN_BOTTOM&&i.ontouch(e,i.onTouchCallback.bind(i)),i.DOMmanipulations(t)}})()},onscroll:function(e,t){window.innerHeight+window.scrollY>=document.body.scrollHeight?e.hasClass(t,e.CLASS_HIDDEN)||e.configuration.mainClass!==window.Demandbase.SiteOptimization.CLASS_MAIN_BOTTOM||e.addClass(t,e.CLASS_HIDDEN):e.hasClass(t,e.CLASS_HIDDEN)&&e.removeClass(t,e.CLASS_HIDDEN)},ontouch:function(e,t){var i,n,o,a,s,r,l,c=e,d=t||function(e,t,i,n,o){};Demandbase.Utilities.addEventListener(c,"touchstart",function(e){var t=e.changedTouches[0];n=i="none",o=t.pageX,a=t.pageY,l=(new Date).getTime(),e.stopPropagation()}),Demandbase.Utilities.addEventListener(c,"touchmove",function(e){var t=e.changedTouches[0];s=t.pageX-o,r=t.pageY-a,Math.abs(s)>Math.abs(r)?d(e,i=s<0?"left":"right","move",n,s):d(e,i=r<0?"up":"down","move",n,r),e.preventDefault()}),Demandbase.Utilities.addEventListener(c,"touchend",function(e){(new Date).getTime()-l<=500&&(150<=Math.abs(s)&&Math.abs(r)<=100||150<=Math.abs(r)&&Math.abs(s)<=100)&&(n=i),d(e,i,"end",n,"left"===i||"right"===i?s:r),e.preventDefault()})},onWidgetClick:function(t){var i=this;Demandbase.Utilities.addEventListener(t,"click",function(e){e.target.className!==i.CLASS_CLOSE_BUTTON&&(i.hasClass(t,i.CLASS_CLOSED)?(i.removeClass(t,i.CLASS_CLOSED),i.addClass(t,i.CLASS_OPENED),i.setItemToStorage(i.SESSION_BLOCK_OPEN_STATE,"true"),i.sendGoogleAnalyticsEvent("AI personalization - Company Logo","click: open block","Company SID: "+i.configuration.recommendationCompanyId)):i.configuration.mainClass===i.CLASS_MAIN_BOTTOM&&(i.hasClass(e.target,"affect")||i.hasClass(e.target.parentNode,"affect")||(i.removeClass(t,i.CLASS_OPENED),i.addClass(t,i.CLASS_CLOSED),i.setItemToStorage(i.SESSION_BLOCK_OPEN_STATE,"false"),i.sendGoogleAnalyticsEvent("AI personalization - Company Logo","click: open block","Company SID: "+i.configuration.recommendationCompanyId))))})},sendFeedback:function(e){var t=new XMLHttpRequest,i={served_sid:parseInt(this.configuration.recommendationCompanyId),corrected_company_name:e,url:window.location.href};t.open("POST","https://ai-personalization-prod-api.demandbase.com/feedback",!0),t.setRequestHeader("Content-type","application/json"),t.onload=this.feedbackResponseHandler.bind(this,t),t.send(Demandbase.Shims.JSON.stringify(i))},feedbackInputKeyupCallback:function(e){(void 0!==e.key&&"Enter"==e.key||void 0!==e.keyCode&&("Enter"==e.keyCode||13==e.keyCode))&&this.sendFeedback(e.target.value)},onFeedbackSend:function(){var e=document.querySelector(".recommended-block__feedbackLinkDiv__popup__input");e&&Demandbase.Utilities.addEventListener(e,"keyup",this.feedbackInputKeyupCallback.bind(this))},onCloseWidget:function(e,t){var i=document.querySelectorAll("."+e.CLASS_CLOSE_BUTTON)[0];i&&Demandbase.Utilities.addEventListener(i,"click",function(){e.hasClass(t,e.CLASS_OPENED)&&(e.removeClass(t,e.CLASS_OPENED),e.addClass(t,e.CLASS_CLOSED),e.setItemToStorage(e.SESSION_BLOCK_OPEN_STATE,"false"))})},buildItems:function(e,t,i){var n=e.recommendations;n&&(t&&(n=n.slice(0,t)),this.buildRecommendationsItems(i,n,"."+this.CLASS_LIST))},buildLogo:function(e,t){if(e.logo&&this.configuration.showLogo){if(this.configuration.showLogoWhenClosed){var i=document.querySelectorAll("."+this.CLASS_TITLE)[0];this.addClass(document.querySelectorAll("."+this.CLASS_CLOSED_CONTENT)[0],"mrg-btm"),document.querySelectorAll("."+this.CLASS_CLOSED_CONTENT)[0].insertBefore(this.buildOpenedOrClosedLogo(e.logo),i)}if(this.configuration.showLogoWhenOpen){var n=document.querySelectorAll("."+this.CLASS_OPEN_TITLE)[0];document.querySelectorAll("."+this.CLASS_OPEN_TITLE_WRAPPER)[0].insertBefore(this.buildOpenedOrClosedLogo(e.logo),n)}}},buildWidgetToggle:function(e){var t=e.querySelectorAll("."+this.CLASS_LIST+" ."+this.CLASS_LIST_ITEM);this.configuration.isSwitchersDots?this.buildSwitcher(e,t.length):this.configuration.isSwitchersArrows&&this.buildArrows(e,t.length)},DOMmanipulations:function(t){var i=this,n=document.querySelectorAll("."+this.CLASS_ROOT)[0],e=this.configuration.isSwitchersDots||this.configuration.isSwitchersArrows||!this.ifRightRailed()?null:this.getRecommendationsLimit();this.onWidgetClick(n),this.addFeedbackClickHandler(this),this.onFeedbackSend(this),this.onCloseWidget(this,n),this.buildItems(t,e,n),this.checkLogoImageIsAvailable(t.logo,function(e){return i.buildLogo(t,n)}),this.buildWidgetToggle(n),this.setStyles()},ready:function(e){var t=this;"loading"!==document.readyState?Demandbase.ErrorReporter.wrap(function(){return e.call(t)})():Demandbase.Utilities.addEventListener(document,"DOMContentLoaded",Demandbase.ErrorReporter.wrap(e.bind(this))())},getRecommendations:function(e,t,i,n,o,a){var s=new XMLHttpRequest,r=window.btoa(t),l=(a||this.configuration.recommendationApiURL)+encodeURI(e)+"?page="+encodeURI(r)+"&apiKey="+encodeURI(i);!0===this.configuration.solveConversionProbabilities&&(l+="&solveConversionProbabilities=true"),s.open("GET",l,!0),s.withCredentials=!0,s.onload=function(){if(200<=s.status&&s.status<400){var e=Demandbase.Shims.JSON.parse(s.responseText);n&&n(e)}else o&&o()},s.onerror=function(){o()},s.send()},buildRecommendationsItems:function(e,t,i){var n=0!==e.querySelectorAll(i).length?e.querySelectorAll(i)[0]:e.querySelectorAll("."+this.CLASS_LIST)[0];n.innerHTML="";var o=this.MAX_NUMBER_OF_ITEMS,a=this.DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE,s=this.configuration.isSwitchersDots||this.configuration.isSwitchersArrows;this.ifRightRailed()&&!s&&(a=o),t.length<6&&(o=t.length);for(var r="",l="",c=0;c<o;c++){this.configuration.mainClass!==this.CLASS_MAIN_BOTTOM&&a-1<c&&(l='style="display:none"'),0===c&&(l='style="left:0"'),r+='<li class="'+this.CLASS_LIST_ITEM+' affect"'+l+">",this.isAdmin&&(r+=this.buildConversionPopup(t[c]));var d="http://";"forceHTTPS"===this.configuration.recommendationsProtocol&&(d="https://");var m=t[c].title;m=m.length<=95?m:m.substring(0,95)+"...";var u=this.getIndicatorArrow();r+='<div class="recommended-block__list__recommended-item__image-wrapper"><div class="recommended-block__list__recommended-item__image-table-row-wrapper"><div class="recommended-block__list__recommended-item__image-table-cell-wrapper"><a onclick="window.Demandbase.SiteOptimization.itemOnClick(event)" href="'+d+t[c].page+'"><img src="'+t[c].image+'" alt="Preview" class="recommended-block__list__recommended-item__img"></div></div></a><a onclick="window.Demandbase.SiteOptimization.itemOnClick(event)" class="'+this.CLASS_LIST_ITEM_TITLE+'" href="'+d+t[c].page+'">'+m+u+"</a></div></li>"}n.innerHTML=r},itemOnClick:function(e){var t=this.findAncestor(e.target,this.CLASS_LIST_ITEM),i=document.querySelectorAll("."+this.CLASS_LIST)[0],n=Demandbase.Shims.indexOf(i.children,t),o="";o=this.hasClass(e.target,"recommended-block__list__recommended-item__img")?e.target.parentNode.getAttribute("href"):e.target.getAttribute("href"),this.sendGoogleAnalyticsEvent("AI personalization - Content recommendation","click","Destination URL:"+o+" | Location of the asset:"+n)},buildSwitcher:function(e,t){var o=474;this.configuration.mainClass!==this.CLASS_MAIN_DEFAULT&&(o=297);var a=this.DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE,i=t%3==0?t/3:t/3+1,s=e.querySelectorAll("."+this.CLASS_LIST)[0];if(1<i){for(var n='<li class="'+this.CLASS_SWITCHER_CONTROL_ITEM+' _active"></li>',r='<li class="'+this.CLASS_SWITCHER_CONTROL_ITEM+'"></li>',l=document.querySelectorAll("."+this.CLASS_SWITCHER_CONTROL)[0],c="",d=i-1;0<d;d--)c+=r;l.innerHTML=n+c;var m=l.querySelectorAll("."+this.CLASS_SWITCHER_CONTROL_ITEM),u=this;Array.prototype.forEach.call(m,function(i,n){Demandbase.Utilities.addEventListener(i,"click",function(e){if(!u.hasClass(i,"_active")){Array.prototype.forEach.call(m,function(e,t){u.removeClass(e,"_active")}),u.addClass(i,"_active"),s.style.left=-1*o*n+"px";var t=s.querySelectorAll("."+u.CLASS_LIST_ITEM);Array.prototype.forEach.call(t,function(e,t){e.style.left=o*n+"px",Math.floor(t/a)===n?e.style.display="block":e.style.display="none"})}})})}},buildOpenedOrClosedLogo:function(e){var t=window.Demandbase.SiteOptimization,i=document.createElement(t.DIV);return t.addClass(i,t.CLASS_LOGO_WRAPPER),i.innerHTML='<img src="'+e+'" alt="Company Logo" class="recommended-block__logo-wrapper__logo">',i},checkLogoImageIsAvailable:function(e,t){var i=new Image;i.onload=function(){return t({logoUrl:e})},i.onerror=function(e){},i.src=e},buildArrows:function(e,t){var i=e.querySelectorAll(".recommendation-block__arrows-list")[0];if(3<=t){var n="";this.configuration.switcherArrowsColor&&(n='style="border-color: '+this.configuration.switcherArrowsColor+'"');var o="<div "+n+" class='recommended-block_arrows-part affect'></div>";i.innerHTML="<div class='recommendation-block__arrows-list_common left-arrow _inactive'><div class='recommended-block_arrows-part_round affect'></div>"+o+"</div><div class='recommendation-block__arrows-list_common right-arrow'><div class='recommended-block_arrows-part_round affect'></div>"+o+"</div>";var a=i.querySelector(".left-arrow .recommended-block_arrows-part"),s=i.querySelector(".right-arrow .recommended-block_arrows-part"),r=e.querySelectorAll("."+this.CLASS_LIST)[0],l=r.querySelectorAll("."+this.CLASS_LIST_ITEM);r.style.left="0";function c(){var e=l.length,t=850<window.innerWidth?3:2;return{sliderWrapperWidth:r.parentNode.clientWidth,numberOfSlidesInSection:t,sliderPosition:Math.abs(parseInt(r.style.left)),numberOfSections:Math.ceil(e/t)}}var d=this;Demandbase.Utilities.addEventListener(a,"click",function(){var e=c();e.sliderPosition&&(r.style.left=e.sliderPosition/e.sliderWrapperWidth<1?"0px":-e.sliderWrapperWidth*(Math.ceil(e.sliderPosition/e.sliderWrapperWidth)-1)+"px"),m(r.style.left,e.sliderWrapperWidth,e.numberOfSections,!1)}),Demandbase.Utilities.addEventListener(s,"click",function(){var e=c(),t=!1;if(e.sliderPosition<e.sliderWrapperWidth*(e.numberOfSections-1)){var i=-e.sliderWrapperWidth*Math.floor(1+e.sliderPosition/e.sliderWrapperWidth),n=(e.sliderWrapperWidth-l[0].clientWidth*e.numberOfSlidesInSection)/(2*e.numberOfSlidesInSection);if(l.length%e.numberOfSlidesInSection&&Math.abs(i)===(e.numberOfSections-1)*e.sliderWrapperWidth)i+=(2*n+l[0].clientWidth)*(e.numberOfSlidesInSection-l.length%e.numberOfSlidesInSection),t=!0}r.style.left=i+"px",m(r.style.left,e.sliderWrapperWidth,e.numberOfSections,t)});var m=function(e,t,i,n){d.toggleClass(a.parentNode,"_inactive",0===Math.abs(parseInt(e))),d.toggleClass(s.parentNode,"_inactive",n||Math.abs(parseInt(e))===(i-1)*t)}}if(3===t)for(var u=document.querySelectorAll(".recommended-block_arrows-part"),h=0;h<u.length;h++)u[h].style.display="none";return i},overrideSid:function(){return this.getQueryVariable("sid")||null},applyOverrideSid:function(e){return e.demandbase_sid=this.overrideSid()?this.overrideSid():e.demandbase_sid,e},isPersonalizationBlacklist:function(e){for(var t=0;t<this.PERSONALIZATION_BLACKLIST_DOMAINS.length;t++)if(this.PERSONALIZATION_BLACKLIST_DOMAINS[t]===e)return!0;return!1},setRecommendationsData:function(e){e=this.applyOverrideSid(e),(this.configuration.companyProfile=e).demandbase_sid&&(this.configuration.recommendationCompanyId=e.demandbase_sid,this.configuration.recommendationCompanyName=e.marketing_alias,e.web_site&&this.isPersonalizationBlacklist(e.web_site)&&(this.configuration.showLogo=!1,this.configuration.recommendationCompanyName=""),this.ready(this.recommendationRequest))},ifRightRailed:function(){return this.configuration.additionalClass===this.CLASS_RIGHT_RAIL},getRecommendationsLimit:function(){if(this.configuration.mainClass!==this.CLASS_MAIN_RIGHT)return null;for(var e=[{moreThen:0,lessThen:370,limit:this.DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE-1},{moreThen:370,lessThen:450,limit:this.DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE},{moreThen:450,lessThen:530,limit:this.DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE+1},{moreThen:530,lessThen:605,limit:this.DEFAULT_NUMBER_OF_ITEMS_ON_SLIDE+2}],t=document.documentElement.clientHeight,i=null,n=0;n<e.length;n++){var o=e[n];t>=o.moreThen&&t<=o.lessThen&&(i=o)}return i?i.limit:null},_getIPAPIURL:function(){return((window.Demandbase.Config||{}).IPApiModule||{}).baseUrl||"https://api.company-target.com/api/v2/ip.json"},checkInitialData:function(){var t=new XMLHttpRequest,e=(window.Demandbase.Config||{}).isVoltronEnabled?"auth":"key",i=this._getIPAPIURL()+"?"+e+"="+encodeURI(this.configuration.recommendationKey)+"&src=siteOptimization";t.open("GET",i,!0);var n=this;t.onload=function(){if(200<=t.status&&t.status<400){var e=Demandbase.Shims.JSON.parse(t.responseText);n.setRecommendationsData(e)}},t.onerror=function(){},t.send()},getQueryVariable:function(e){return Demandbase.Utilities.getQueryParam(e)}},void 0!==window.Demandbase.Config&&void 0!==window.Demandbase.Config.SiteOptimization&&void 0!==window.Demandbase.SiteOptimizationLoader&&Demandbase.ErrorReporter.wrap(function(){window.Demandbase.SiteOptimization.initialize(window.Demandbase.SiteOptimizationLoader.configuration)})();